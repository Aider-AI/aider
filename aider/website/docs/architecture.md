---
nav_order: 470
has_children: true
description: Overview of Aider's architecture and key components.
---

# Architecture Overview

Aider is a command line tool that integrates large language models (LLMs) with local git repositories. It orchestrates the conversation with the LLM, applies edits to the working tree, and automatically commits changes. The design centers around a `Coder` class hierarchy which coordinates repository mapping, chat summarization and model interaction.

<div class="mermaid">
graph TD
    A[aider.main] --> B[Coder.create]
    B --> C[RepoMap]
    B --> D[GitRepo]
    B --> E[ChatSummary]
    B --> F[InputOutput]
    B --> G[Model]
    D --> H[gitpython]
    F --> I[chat_history.md]
</div>

## Key modules

- **CLI startup (`aider/main.py`)**
  parses arguments, selects a model via onboarding, sets up git, and constructs the initial `Coder` instance.
- **Coders (`aider/coders/`)**
  manage prompts and apply edits. `base_coder.py` implements common behavior while specialized coders like `ArchitectCoder` or `AskCoder` provide different chat modes. `Coder.create()` picks a subclass based on the selected edit format.
- **Git integration (`aider/repo.py`)**
  wraps GitPython to stage files, generate diffs and create commits. `auto_commit()` summarizes edits and reports commit hashes in chat.
- **Model management (`aider/models.py`)**
  describes model metadata and integrates with `litellm` for API calls. Each model sets `max_chat_history_tokens` (about 1/16 of its context window) so chat history can be summarized before it grows too large.
- **RepoMap (`aider/repomap.py`)**
  summarizes important files and identifiers to provide targeted context to the model when editing a large repository.
- **Chat history (`aider/history.py`)**
  compactly summarizes older messages. A background thread is launched when the history exceeds `max_chat_history_tokens`.
- **Onboarding (`aider/onboarding.py`)**
  selects a default model from available API keys or triggers OpenRouter OAuth if none are found.

## Prompt assembly

`ChatChunks` groups system prompts, repo summaries, examples and conversation history before sending messages to the model. Certain segments are marked as cacheable so providers can reuse them across requests.

Specialized coders adjust the prompts and workflow. For example, architect mode first generates high level instructions with an architect model and then applies edits with the main model. The edit format controls how diffs or whole files are returned.

## Memory and cost management

Aider monitors token usage on every request. If a message would exceed the model's context window, the user is warned and chat history is summarized. The total tokens and estimated cost are tracked for the session. With `--restore-chat-history`, prior conversations from `chat_history.md` are loaded and summarized when Aider starts so context is retained across sessions.

## Git workflow

Aider edits the working tree directly. If `--auto-commit` is enabled, each batch of edits is automatically committed with a message generated by the model. The commit includes optional attribution trailers so it is clear which changes were made by Aider. Users can revert or inspect diffs using normal git commands.

## Further reading

- The [usage guide](usage.html) explains the basic workflow.
- The [git integration](git.html) page details how commits are created.
- The [edit formats](more/edit-formats.html) page describes the formats supported by different models.

## In-depth topics

The following sections dive deeper into Aider's internal architecture and implementation details.
